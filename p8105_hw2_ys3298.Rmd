---
title: "p8105_hw2_ys3298"
author: "Yimeng SHANG"
date: "9/26/2019"
output: github_document
---
# PROBLEM1
```{r}
library(tidyverse)
library(readxl)

trash_wheel = read_excel("../data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 1) %>%
  janitor::clean_names() %>%
  filter(dumpster != "NA") %>%
  mutate(sports_balls = as.integer(sports_balls))
typeof(trash_wheel$sports_balls) 

precipi2018 = read_excel("../data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 3, skip = 1) %>% 
  janitor::clean_names() %>%
  filter(total != "NA") %>%
  filter(month != "NA") %>%
  mutate(year = "2018")
total2018 = sum(pull(precipi2018, total))

precipi2017 = read_excel("../data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 4, skip = 1) %>% 
  janitor::clean_names() %>%
  filter(total != "NA") %>%
  filter(month != "NA") %>%
  mutate(year = "2017")

precipi = bind_rows(precipi2017, precipi2018) %>%
  select(year, month, total) %>%
  mutate(month = month.name[month])
total2017 = sum(pull(precipi2017, total))
```
```{r include=FALSE}
year2018 = filter(trash_wheel, year == "2018")
year2017 = filter(trash_wheel, year == "2017")
year2016 = filter(trash_wheel, year == "2016")
year2015 = filter(trash_wheel, year == "2015")
year2014 = filter(trash_wheel, year == "2014")
```

From the data, we can notice that the total precipitations for 2014-2018 are 51.59, 43.21, 39.95, `r total2017` and `r total2018` respectively, which decrease year by year. The median numbers of sports balls in a dumpster in 2014-2018 are `r median(year2014$sports_balls)`, `r median(year2015$sports_balls)`, `r median(year2016$sports_balls)`, `r median(year2017$sports_balls)`, `r median(year2018$sports_balls)`. The mean numbers of plastic bottle in a dumpster in 2014-2018 are `r median(year2014$plastic_bottles)`, `r median(year2015$plastic_bottles)`, `r median(year2016$plastic_bottles)`, `r median(year2017$plastic_bottles)`, `r median(year2018$plastic_bottles)`. The mean numbers of grocery bags in 2014-2018 are `r round(mean(year2014$grocery_bags), 0)`, `r round(mean(year2015$grocery_bags), 0)`, `r round(mean(year2016$grocery_bags), 0)`, `r round(mean(year2017$grocery_bags), 0)`, `r round(mean(year2018$grocery_bags), 0)`. From these data, we can easily noticed that the number of sports balls, plastic bottle and grocery bags firstly increased and then decrease from 2014 to 2018.

# PROBLEM2
```{r}
pols = read_csv("../data/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day")) %>%
  mutate(month = month.abb[as.factor(month)],
         president = factor(prez_gop, labels = c("dem", "gop", "others(shows as 2 in prez_gop)"))) %>%
  select(-prez_dem, -prez_gop, -day)

snp = read_csv("../data/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("day", "month", "year")) %>%
  arrange(year, as.integer(month)) %>%
  mutate(month = month.abb[as.factor(month)]) %>%
  select(year, month, everything())

unemploy = read_csv("../data/unemployment.csv")
tidy_unemploy = 
  pivot_longer(
    unemploy,
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment") %>%
  select(year = Year, everything()) %>%
  mutate( year = as.character(year))

snp_pols = left_join(pols, snp, by = c("year", "month"))
snp_pols_unemploy = left_join(tidy_unemploy, snp_pols, by = c("year", "month"))
```

```{r}
names = read_csv("../data/Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  mutate(
    childs_first_name = str_to_upper(childs_first_name)) 

names$ethnicity[names$ethnicity == "ASIAN AND PACI"] = "ASIAN AND PACIFIC ISLANDER"
names$ethnicity[names$ethnicity == "BLACK NON HISP"] = "BLACK NON HISPANIC"
names$ethnicity[names$ethnicity == "WHITE NON HISP"] = "WHITE NON HISPANIC"

names = distinct(names)
# unique(names)
dim(names)
```

```{r}
# showing the rank in popularity of the name “Olivia” 
olivia = subset(names, names$childs_first_name == "OLIVIA") %>%
  select(year_of_birth, ethnicity, rank) %>%
  pivot_wider(
    names_from = ethnicity,
    values_from = rank) %>%
    arrange(year_of_birth)
olivia 

# showing the most popular name among male children 
popular_male = filter(names, gender == "MALE") %>%
  select(-gender, -count) %>%
  filter(rank == "1") %>%
  select(-rank) %>%
  pivot_wider(
    names_from = ethnicity,
    values_from = childs_first_name) %>%
  arrange(year_of_birth)
popular_male

# a scatter plot showing the number of children with a name (y axis) against the rank in popularity of that name (x axis)
male = filter(names, gender == "MALE") %>%
  filter(year_of_birth == "2016") %>%
  filter(ethnicity == "WHITE NON HISPANIC")
ggplot(male, aes(x = rank, y = count)) + geom_point(color = "blue") + ggtitle("WHITE NON HISPANIC count vs rank")

```







